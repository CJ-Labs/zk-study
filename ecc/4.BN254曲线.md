# 1. 基本概念
BN254（Barreto-Naehrig）是一种特殊的配对友好椭圆曲线，主要用于聚合签名和零知识证明系统
- 254 位素数阶 
  - （阶 = 群 = 元素个数）
  - 素数阶 = 群的大小是素数
  - 254位素数 < 2²⁵⁴
- 支持高效的```双线性配对```运算
# 2. 核心特性
## 2.1 曲线参数
- 基域 Fp：
- p=21888242871839275222246405745257275088696311157297823662689037894645226208583
- 群阶 r：
- r = 21888242871839275222246405745257275088548364400416034343
- 曲线方程
- ```y² = x³ + 3```

## 2.2 群结构
1. G1 群（基础域上的点群）
- 在 Fp 上的点 (x,y)
- x 和 y 都是基础域的元素
- 坐标是普通的大整数（mod p）
```
点 P = (x,y)，其中：
x,y ∈ Fp（即 0 到 p-1 之间的整数）
```
2. G2 群（二次扩域上的点群）
- 在 Fp² 上的点
- 坐标是复数形式：a + bi
- 需要两倍存储空间
```
点 Q = (x₁ + x₂i, y₁ + y₂i)
其中 x₁,x₂,y₁,y₂ ∈ Fp
```
3. GT 群（目标群）
定义：
- 在 Fp¹² 上的元素
- 配对运算 e(P,Q) 的结果所在的群
- 是乘法群（不是加法群）
```
性质：
e: G1 × G2 → GT
e(P,Q) ∈ GT
```

## 2.3 双线性配对
// BN254 曲线上的双线性配对运算
```e: G1 × G2 → GT```
其中：
- P ∈ G1
- Q ∈ G2
- 结果在 GT 中
// 满足双线性性质
```e(aP, bQ) = e(P, Q)^(ab)```

# 3. 为什么被广泛使用
## 3.1  性能优势
1. 计算效率高
```go
// G1 点的高效运算
func (p *G1) Add(p1, p2 *G1) 
func (p *G1) ScalarMult(p1 *G1, scalar *big.Int)
```
2. 配对运算优化
```go
// 优化的配对计算
func Pair(P *G1, Q *G2) *GT
```
# 4. 补充概念
## 4.1 Fp 是有限域（Finite Field）的标准数学符号
```
F: Field（域）
p: 特征数（这里是一个素数）

Fp 表示：模p的有限域
所有运算都在 mod p 下进行
```
举例 F5（模5的有限域）
```
元素：{0,1,2,3,4}

加法例子：
3 + 4 = 2 (因为 7 mod 5 = 2)

乘法例子：
3 × 4 = 2 (因为 12 mod 5 = 2)
```
- 封闭性： 任何运算结果都在 0 到 p-1 之间
- 可逆性： 除了0外，所有元素都有乘法逆元
- 有限性： 总共有 p 个元素
<br/>

简单理解为 ```一共有p个元素，运算结果不能超过 p```
# 5. 实际应用
## 5.1 BLS签名
- 私钥: x
- 公钥: ```P = xG1``` (G1是G1群的生成元)
- 签名: ```σ = x·H(m)``` (H(m)映射到G2)
- 验证: ```e(G1,σ) = e(P,H(m))```
## 5.2 
代码实现
<br/>

[go BN254](https://github.com/Consensys/gnark-crypto/blob/master/ecc/bn254/bn254.go)
<br/>

[solidity BN254](./code/BN254.sol)

# 6. 简单理解：
- G1 像是"简单数"
- G2 像是"复数"
- GT 是它们配对后的"结果空间"

# 7. 实际开发的几个 tip
## 1. 仿射坐标（Affine）和雅可比坐标（Jacobian
1. G1Affine（仿射坐标）
- 表示形式：(x, y)
- 存储空间小，适合存储

2. G1Jac（雅可比坐标）
- 表示形式：(X, Y, Z)
- 对应的仿射坐标：(X/Z², Y/Z³)
- 加法和倍乘更快
- 适合计算，不适合存储